<h1 align = "center">waver_description package</h1>

## Overview

The `waver_description` package provides a 3D model and the corresponding URDF files for the [Wave Rover](https://www.waveshare.com/wave-rover.htm) robot, including an integrated LIDAR sensor, IMU, camera and Depth camera model. This package was developed using the [3D model](https://www.waveshare.com/wiki/WAVE_ROVER#Robot_Model) provided by Waveshare.

The 3D model was imported into [Fusion 360](https://www.autodesk.com/products/fusion-360) in order to separate the meshes, and generate the URDF files using [fusion2urdf](https://github.com/syuntoku14/fusion2urdf) tool. Modifications were made to the files generated by URDF_Exporter such as the robot's orientation, robot scale, joints, inertia and others. The robot's link inertia matrix was fixed using [calc-inertia](https://github.com/gstavrinos/calc-inertia?tab=readme-ov-file#calc_inertiapy).

The package includes:

- **Meshes and URDF files:** These files define the physical and kinematic properties of the Wave Rover, enabling accurate representation and simulation of the robot in a virtual environment.
- **Gazebo Sim Integration:** The simulation utilizes native Gazebo Sim system plugins. Sensors are managed via `libgz-sim-sensors-system.so`, while kinematic control is handled either by `libgz-sim-diff-drive-system.so` or `gz_ros2_control`.
- **IMU:** Integrated IMU sensor model (`type="imu"`) providing orientation and acceleration data, processed by the native sensors system.
- **LIDAR LD19:** Model of the [LIDAR sensor](https://www.waveshare.com/wiki/DTOF_LIDAR_LD19#3D_Model) (`type="gpu_lidar"`), configured to publish laser scan data via the internal simulation bridge.
- **Raspberry Pi Camera:** Standard RGB [camera model](https://www.printables.com/model/368779-raspberry-pi-camera-module-3-v3) (`type="camera"`), providing raw image streams.
- **ZED X Mini:** [Depth camera model](https://github.com/stereolabs/zed-ros2-interfaces/blob/master/meshes/zedxm.stl) (`type="depth_camera"`), providing depth sensing capabilities.

This package is essential for spawning the Wave Rover robot in a simulation environment.

## Dependencies

**Required ROS2 packages**

- `xacro`
- `joint_state_publisher`
- `robot_state_publisher`

**Simulation Dependencies**

- `ros_gz` (for bridging topics between Gazebo Sim and ROS 2)
- `gz_ros2_control` (if using `sim_control:=ros2`)

## Usage

This package can be launched using the project's helper aliases (inside the Docker container) or via standard ROS2 launch commands.

### Docker container environment (Recommended)

If you are working within the provided Docker environment, a helper function `waver` is defined in `autostart.sh` to simplify the build, source, and launch process.

To view the robot model in RViz with the Joint State Publisher:

```bash
waver description
```

### Standard ROS2 environment

If you are not using the Docker container or prefer standard ROS2 commands, ensure your workspace is built and sourced, then launch the package manually using `ros2 launch`:

```bash
ros2 launch waver_description description.launch.xml
```

#### Launch arguments

The main entry point is `description.launch.xml`. It loads the robot model into the `robot_description` parameter (via `xacro`) and starts `joint_state_publisher` + `robot_state_publisher` so you can visualize the robot (e.g., in RViz2) and publish TF.

**Available arguments**

- `use_sim_time` _(bool)_: If `true`, the nodes will subscribe to the `/clock` topic for time synchronization. This is required when running the robot in simulators like Gazebo.
  Default: `true`

- `model` _(string)_: Path to the robot model file to load (URDF or Xacro).
  Default: `$(find-pkg-share waver_description)/urdf/waver.xacro`

- `sim_control` _(string)_: Defines the simulation control backend configuration to load.
  Default: `gazebo`
  Options:

  - `gazebo`: Loads configuration for the native Gazebo Sim Diff Drive plugin `libgz-sim-diff-drive-system.so`.
  - `ros2`: Loads configuration for ROS 2 Control (hardware interfaces via `gz_ros2_control-system`)

- `camera_type` _(string)_: Selects the camera model to be mounted on the robot.
  Default: `raspi`
  Options:

  - `raspi`: Mounts the Raspberry Pi Camera.
  - `depth`: Mounts the ZED X Mini stereo camera.
